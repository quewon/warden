<!DOCTYPE html>
<html>
<head>
	<title>warden</title>
	<style>
		:root {
			/*
			primary: player + things player cannot affect
			secondary: pull/draggable
			bg: background + detailwork
			*/

			/* FRESH SODA (DARK)
			--bg: #056676;
			--primary: #e8ded2;
			--secondary: #5eaaa8;
			*/

			/* BABY BOY (LIGHT)
			--bg: #f6f5f5;
			--primary: #145374;
			--secondary: #ee6f57;
			*/

			/* MINIONS AND PLUMS (DARK)
			--bg: #3c2946;
			--primary: #ffd571;
			--secondary: #56556e;
			*/

			/* MILK & TEA (LIGHT)
			--bg: #f5f1da;
			--primary: #96bb7c;
			--secondary: #eebb4d;
			*/

			--bg: #056676;
			--primary: #e8ded2;
			--secondary: #5eaaa8;

			--border: 3px dashed var(--gui);
			--size: 240px;

			font-family: monospace;
			background-color: var(--bg);
			color: var(--primary);
		}
		canvas {
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			width: var(--size);
			height: var(--size);
		}
		#map {
			width: var(--size);
			height: var(--size);
			border: var(--border);
			-webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
			-moz-box-sizing: border-box;    /* Firefox, other Gecko */
			box-sizing: border-box;         /* Opera/IE 8+ */
			visibility: hidden;
		}

		div {
			margin-top: 10px;
			text-align: center;
			-webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
			-moz-box-sizing: border-box;    /* Firefox, other Gecko */
			box-sizing: border-box;         /* Opera/IE 8+ */
		}
	</style>
</head>

<body>
	<div>[WASD] TO MOVE<br />[SPACE] TO INTERACT & DRAG</div>
	<canvas id="main_canvas" width="960" height="960"></canvas><canvas id="map" width="960" height="960"></canvas>
</body>

<script>
	var style = getComputedStyle(document.body);
	var canvas = document.getElementById("main_canvas");
	var c = canvas.getContext('2d');
	var width = canvas.width, height = canvas.height;

	var map_canvas = document.getElementById("map");
	var map_c = map_canvas.getContext('2d');

	var cellsize = Math.round(width/8);
	var pixelsize = cellsize/8;

	//animation loop
	function animate() {
		requestAnimationFrame(animate);
		c.clearRect(0, 0, width, height);

		drawRoom(int.player.room);
		drawInts();

		map_c.clearRect(0, 0, width, height);
		drawMap();
	}

	var interacting = false;
	var dragging = false;

	function keydown(event) {
		event = event || window.event;
		let key = event.key || event.which || event.keyCode;

		if (key=='w') { move('player', 0) }
		else if (key=='a') { move('player', 1) }
		else if (key=='s') { move('player', 2) }
		else if (key=='d') { move('player', 3) }

		if (key==' ') { interacting = true }
	}

	function keyup(event) {
		event = event || window.event;
		let key = event.key || event.which || event.keyCode;

		if (key==' ') {
			let subject = surrounding('player')[0];
			if (subject && !dragging) { interact(subject); }
			interacting = false;
			dragging = false;
		}
	}
</script>
<script src="room.js"></script>
<script src="int.js"></script>
<script>
	window.onkeydown = keydown;
	window.onkeyup = keyup;

	mapGen();
	animate();
</script>

</html>